(()=>{"use strict";function t(){const t=document.querySelector("body").innerHTML;window.localStorage.setItem("state",JSON.stringify(t))}const e=new class{constructor(){this.html='\n\t  <div class="container">\n\t  <div class="column">\n\t\t  <div class="column__title">\n\t\t\t  <span class="column__text">Todo</span>\n\t\t\t  <span class="column__options">...</span>\n\t\t  </div>\n\t\t  <div class="column__content">\n\t\t\t  <div class="item">\n\t\t\t\t  <div class="item__title">\n\t\t\t\t\t  <span class=\'item__text\'>Go for a walk</span>\n\t\t\t\t\t  <div class=\'item__delete hidden\'>✕</div>\n\t\t\t\t  </div>\n\t\t\t  </div>\n\t\t\t  <div class="item">\n\t\t\t\t  <div class="item__title">\n\t\t\t\t\t  <span class=\'item__text\'>Watch a movie</span>\n\t\t\t\t\t  <div class=\'item__delete hidden\'>✕</div>\n\t\t\t\t  </div>\n\t\t\t  </div>\n\t\t  </div>\n\t\t  <div class="column__footer">+ Add another card</div>\n\t  </div>\n\t  <div class="column">\n\t\t  <div class="column__title">\n\t\t\t  <span class="column__text">In progress</span>\n\t\t\t  <span class="column__options">...</span>\n\t\t  </div>\n\t\t  <div class="column__content">\n\t\t\t  <div class="item">\n\t\t\t\t  <div class="item__title">\n\t\t\t\t\t  <span class=\'item__text\'>Learn JavaScript</span>\n\t\t\t\t\t  <div class=\'item__delete hidden\'>✕</div>\n\t\t\t\t  </div>\n\t\t\t  </div>\n\t\t  </div>\n\t\t  <div class="column__footer">+ Add another card</div>\n\t  </div>\n\t  <div class="column">\n\t\t  <div class="column__title">\n\t\t\t  <span class="column__text">Done</span>\n\t\t\t  <span class="column__options">...</span>\n\t\t  </div>\n\t\t  <div class="column__content">\n\t\t\t  <div class="item">\n\t\t\t\t  <div class="item__title">\n\t\t\t\t\t  <span class=\'item__text\'>Work out</span>\n\t\t\t\t\t  <div class=\'item__delete hidden\'>✕</div>\n\t\t\t\t  </div>\n\t\t\t  </div>\n\t\t\t  <div class="item">\n\t\t\t\t  <div class="item__title">\n\t\t\t\t\t  <span class=\'item__text\'>Read a book</span>\n\t\t\t\t\t  <div class=\'item__delete hidden\'>✕</div>\n\t\t\t\t  </div>\n\t\t\t  </div>\n\t\t\t  <div class="item">\n\t\t\t\t  <div class="item__title">\n\t\t\t\t\t  <span class=\'item__text\'>Update CV</span>\n\t\t\t\t\t  <div class=\'item__delete hidden\'>✕</div>\n\t\t\t\t  </div>\n\t\t\t  </div>\n\t\t\t  <div class="item">\n\t\t\t\t  <div class="item__title">\n\t\t\t\t\t  <span class=\'item__text\'>Call a friend</span>\n\t\t\t\t\t  <div class=\'item__delete hidden\'>✕</div>\n\t\t\t\t  </div>\n\t\t\t  </div>\n\t\t  </div>\n\t\t  <div class="column__footer">+ Add another card</div>\n\t  </div>\n  </div>',this.footer='\n\t  <div class="column__footer">+ Add another card</div>',this.item="\n\t  <div class=\"item\">\n\t\t  <div class=\"item__title\">\n\t\t\t  <span class='item__text'>New task</span>\n\t\t\t  <div class='item__delete hidden'>✕</div>\n\t\t  </div>\n\t  </div>",this.addTask="\n\t  <div class='add-task'>\n\t\t  <textarea class='add-task__text' placeholder='Write a title for this task...' required></textarea>\n\t\t  <div class='add-task__controls'>\n\t\t\t  <button class='add-task__btn'>Add Card</button>\n\t\t\t  <div class='add-task__cancel'>✕</div>\n\t\t  </div>\n\t  </div>"}},n=new class{constructor(t){this.layout=t,this.item=this.parserHTML(this.layout.item).querySelector(".item"),this.currentItem=null,this.footer=this.parserHTML(this.layout.footer).querySelector(".column__footer")}parserHTML(t){return(new DOMParser).parseFromString(t,"text/html")}init(){const t=function(){try{return JSON.parse(localStorage.getItem("state"))}catch(t){throw console.log(t),new Error("Error to load")}}();document.body.innerHTML=t||this.layout.html,this.container=document.querySelector(".container"),this.container.addEventListener("click",(t=>this.onAddTask(t))),this.container.addEventListener("mouseover",(t=>this.onMouseOver(t))),this.container.addEventListener("mouseout",(t=>this.onMouseOut(t))),this.container.addEventListener("mousedown",(t=>this.onMouseDown(t))),this.container.addEventListener("mouseup",(t=>this.onMouseUp(t)))}onAddTask(e){if(e.target.classList.contains("column__footer")){this.column=e.target.closest(".column"),e.target.remove(),this.column.innerHTML+=this.layout.addTask;const n=this.column.querySelector(".add-task"),s=this.column.querySelector(".column__content"),i=n.querySelector(".add-task__text"),a=n.querySelector(".add-task__btn"),d=n.querySelector(".add-task__cancel");a.addEventListener("click",(()=>{const e=i.value;n.remove(),s.insertAdjacentElement("afterbegin",this.item.cloneNode(!0)),s.querySelector(".item__text").textContent=e,s.insertAdjacentElement("afterend",this.footer.cloneNode(!0)),t()})),d.addEventListener("click",(()=>{n.remove(),s.insertAdjacentElement("afterend",this.footer.cloneNode(!0))}))}}onMouseOver(t){const e=t.target.closest(".item");e&&e.querySelector(".item__delete").classList.contains("hidden")&&e.querySelector(".item__delete").classList.remove("hidden")}onMouseOut(t){const e=t.target.closest(".item");e&&!e.querySelector(".item__delete").classList.contains("hidden")&&e.querySelector(".item__delete").classList.add("hidden")}onMouseDown(e){if(!e.target.classList.contains("add-task__text"))if(e.target.classList.contains("column__footer"))this.container.addEventListener("click",(t=>this.onDeleteTask(t)));else{if(e.target.classList.contains("item__delete"))return e.target.closest(".item").remove(),void t();e.preventDefault(),this.currentItem=e.target.closest(".item"),this.currentItem&&(this.currentItem.classList.add("dragged"),this.currentItem=e.target.closest(".dragged"),this.container.addEventListener("mousemove",this.drag),this.container.addEventListener("mouseup",this.dragEnd),[...document.querySelectorAll(".column")].forEach((t=>{t.addEventListener("mouseup",this.itemDragEnd)})))}}onMouseUp(t){t.preventDefault()}onDeleteTask(e){e.target.classList.contains("item__delete")&&(e.target.closest(".item").remove(),t())}drag(t){if(this.currentItem=document.querySelector(".dragged"),null===this.currentItem)return!1;this.currentItem.style.position="absolute",this.currentItem.style.left=t.clientX-20+"px",this.currentItem.style.top=t.clientY-20+"px"}dragEnd(){if(null===this.querySelector(".dragged"))return!1;this.querySelector(".dragged").classList.remove("dragged"),this.removeEventListener("mousemove",(()=>this.drag)),this.removeEventListener("mouseup",(()=>this.dragEnd)),t()}itemDragEnd(e){const n=document.querySelector(".dragged");if(null===n)return;const s=this.querySelector(".column__content");null===s.querySelector(".item")?s.append(n):s.insertBefore(n,e.target.closest(".item")),n.style="",t()}}(e);n.init()})();